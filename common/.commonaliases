#!/usr/bin/env sh

# allow aliases to be executed with sudo
alias sudo='sudo '

# Uncategorized
alias serve='python3 -m http.server 8888'
alias aur='pushd "${HOME}/dev/projects/maintaining/aur/PKGBUILDs" && source aur-devel.sh && cat aur-devel.sh'


# Navigation
if command -v exa > /dev/null 2>&1; then
    alias ls='exa'
    alias l='exa -Fl'
    alias ll='exa -Fla'
    alias llt='exa -Flar --sort=modified'
    alias lll='exa -FlbghiSm --time-style=long-iso --git'
else
    alias ls='ls -F --color=always'
    alias l='ls -lph'
    alias ll='ls -Alph'
    alias llt='ll -rt'
fi

alias ..='cd ..'
alias r='ranger'


# Info/Introspection/Search
if command -v fd > /dev/null 2>&1; then
    alias f='fd'
    alias fe='fd -e'
    alias fh='fd -H'
    alias fha='fd -HI'
else
    f () {
        find -iname "*${1}*"
        printf "\nYou should install fd.\n"
    }
fi

if command -v ncdu > /dev/null 2>&1; then
    alias du='ncdu -rr'
    alias dum='ncdu'
else
    alias du='du -skh .??* * | sort -rh ; printf "\nYou should install ncdu.\n"'
fi

if command -v dfc > /dev/null 2>&1; then
    alias df='dfc -p /dev,-tmpfs'
else
    alias df='df --exclude-type=tmpfs -h ; printf "\nYou should install dfc.\n"'
fi

if command -v tree > /dev/null 2>&1; then
    alias tree='exa --tree'
    alias treea='exa --tree -aI .git'
else
    alias treea='tree -aI .git'
fi

alias badlinks='find . -xtype l'
alias dmesg='dmesg -xHw'
alias lsblk='lsblk --output=NAME,MOUNTPOINT,TYPE,FSTYPE,LABEL,PARTLABEL,SIZE,UUID'
alias pg='pgrep -f'
psi () {
    ps wup $(pgrep -f "$1")
}
alias pst='pstree -hTp'
alias rg='rg -a'
alias rgh='rg -a --hidden'
alias watchdir='inotifywait -e create,modify,delete -mr'


# Networking
myip () {
    cat <<EOF
Local: $(hostname -i)
External: $(dig +short myip.opendns.com @resolver1.opendns.com)
EOF
}
# Alternatively, local: ip route get 1.1.1.1 | awk '{print $(NF-2); exit}'
# And external: curl -s http://whatismyip.akamai.com
alias ns='sudo netstat -tulpn'


# Filesystem
alias a='atool -Ea'
alias e='atool -Ex'
alias rd='rmdir'
alias shred='shred -zun 10'
alias um='udiskie-mount'
alias uu='udiskie-umount'


# Editing/View
alias c='tput reset'
alias al='atool -El'
alias m='micro'
alias tailf='tail -fn 100'


# Identity / Authentication
alias sshc='$EDITOR ~/.ssh/config'
alias gpgl='gpg2 --list-secret-keys --keyid-format 0xlong'
alias gpgll='gpg2 --list-keys --keyid-format 0xlong'
alias pgp='gpg2 --export -a joshua.r.li.98@gmail.com'


# Web
alias sitemirror='wget --no-config -mpkKE -e robots=off'
alias mdl='youtube-dl --ignore-config --ignore-errors --no-continue --audio-format best -x --add-metadata -o "%(title)s [%(id)s].%(ext)s"'


# Audio
alias audiols='aplay -l ; cat /proc/asound/cards'
alias play='mplayer -vo null -ao alsa'
alias playj='mplayer -vo null -ao jack'
# for video aliases (mpv), refer to .xsrc


# Git
# See also ~/.gitconfig
alias gc='git clone'
alias gcr='git clone --recursive'
alias gup='git submodule update --init --recursive --remote'
alias ga='git add'
alias gaa='git add --all'
alias gs='git status -sb -uall'
alias gi='git show'
alias gcm='git commit -S -m'
alias gl="git log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
alias gp='git push'
alias gpf='git push --force'
alias gb='git branch -vv --all'
alias gnb='git checkout -b'
alias gch='git checkout'
alias master='git checkout master'
alias gd='git diff'
alias gdc='git diff --cached'
alias grao='git remote add origin'
alias grsuo='git remote set-url origin'
alias grv='git remote -v'
gr () {
    [ -n "$1" ] && git reset HEAD~"$1" || git reset
}
vbump () {
    [ -n "$1" ]                     && \
        git add --all               && \
        git commit -S -m "v${1}"    && \
        git tag -s -m "v${1}" "v${1}"
}


# Go
gocd () {
    [ -n "$1" ] && pushd "${GOPATH}/src/github.com/JoshuaRLi/${1}" || pushd "$GOPATH"
}
alias goi='go install'
alias godl='go get -d -v'
alias gog='go get -u -v'
alias depi='dep ensure -add'


# Python
alias p='/usr/bin/env python3'
alias pipi='p -m pip install --user'
alias pipl='p -m pip freeze | less'
alias pipu='p -m pip uninstall'
alias venv='pipenv shell'
alias penew='pipenv --rm ; pipenv install --dev ; pipenv check ; pipenv shell'
alias peup='pipenv update ; pipenv check'
pedump () {
    printf '%s\n' "pwd:  "$(pwd)""
    printf '%s\n' "venv: "$(pipenv --venv)""
    printf '%s\n' "py:   "$("$(pipenv --py)" --version)""
    printf 'packages:\n%s\n' "$(pipenv graph)"
}


# Rust
# See ~/.cargo/config for cargo aliases


# Docker
alias alpine='docker run -it --rm alpine'
alias dls='docker images && printf '\n' && docker ps'
alias dcp='docker container prune -f'
alias dclean='docker stop $(docker ps -a -q) ; dcp ; docker rmi $(docker images -q)'
